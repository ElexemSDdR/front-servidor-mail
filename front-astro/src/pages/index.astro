---
import Layout from '../layout/Layout.astro'
---

<Layout
  title="SCIetetrece - Inbox"
>
  <h1>Servicio de Correo Interno de la 713 (SCIetetrece)</h1>
  <hr>
  
  <div class="container">
      <div class="inbox-section">
          <h2>Bandeja de Entrada</h2>
          <table class="email-table">
              <thead>
                  <tr>
                      <th class="sender">Remitente</th>
                      <th class="subject">Asunto</th>
                      <th class="date">Fecha</th>
                  </tr>
              </thead>
              <tbody id="emailList">
              </tbody>
          </table>
      </div>
      
      <div class="email-preview" id="emailPreview">
          <div class="email-header">
              <h3 class="email-subject" id="previewSubject"></h3>
              <div class="email-meta">
                  De: <span id="previewSender"></span> | 
                  Fecha: <span id="previewDate"></span>
              </div>
          </div>
          <div class="email-body" id="previewBody"></div>
      </div>
  </div>

  <button class="open-button" id="openFormBtn">Redactar correo</button>

  <div class="form-popup" id="myForm">
      <form class="form-container">
          <label for="asunto">Asunto:</label>
          <input type="text" id="asunto" name="asunto" required>
          <br>

          <label for="recipiente">Destinatario:</label>
          <input type="text" id="recipiente" name="recipiente" required>
          <br>

          <label for="cuerpo">Cuerpo:</label>
          <textarea id="cuerpo" name="cuerpo" required></textarea>
          <br>

          <button type="submit" class="btn">Enviar</button>
          <button type="button" class="btn cancel" id="closeFormBtn">Cerrar</button>
      </form>
  </div>

  <script>
      function openForm() {
          document.getElementById("myForm").style.display = "block";
      }

      function closeForm() {
          document.getElementById("myForm").style.display = "none";
      }

      function showEmailPreview(email) {
          document.getElementById('previewSubject').textContent = email.subject;
          document.getElementById('previewSender').textContent = email.sender;
          document.getElementById('previewDate').textContent = email.date;
          document.getElementById('previewBody').textContent = email.body;
          
          const preview = document.getElementById('emailPreview');
          preview.classList.add('active');
      }

      document.addEventListener('DOMContentLoaded', function() {
          // Botones del formulario
          const openButton = document.getElementById('openFormBtn');
          const closeButton = document.getElementById('closeFormBtn');
          const form = document.querySelector('form');
          
          if (openButton) {
              openButton.addEventListener('click', openForm);
          }
          
          if (closeButton) {
              closeButton.addEventListener('click', closeForm);
          }
          
          if (form) {
              form.addEventListener('submit', function(e) {
                  e.preventDefault();
                  alert('Correo enviado (simulaci√≥n)');
                  closeForm();
                  form.reset();
              });
          }
      });
  </script>
</Layout>
