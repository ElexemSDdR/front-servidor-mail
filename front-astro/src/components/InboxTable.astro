<div class="container">
  <div class="inbox-section">
    <h2>Bandeja de Entrada</h2>
    <table class="email-table">
      <thead>
          <tr>
            <th class="sender">Remitente</th>
            <th class="subject">Asunto</th>
          </tr>
      </thead>
      <tbody id="emailList">
      </tbody>
    </table>
  </div>
</div>

<script>
  const $emailList = document.querySelector('#emailList')
  const usrAddress = JSON.parse(localStorage.getItem('addr'))

  const cargarMails = async () => {
    const { address } = usrAddress

    const result = await fetch(`http://192.168.1.105:3000/mail/inbox`, {
      method: 'post',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ address: address })
    })
    const mails = await result.json()
    if (mails.length === 0) {
      $emailList.innerHTML = 'No tenes mails.'
      return
    }

    mails.forEach(mail => {
      const { from_user, subject, id } = mail

      $emailList.innerHTML += `
        <tr class="individualMail" onclick="showMail(${parseInt(id)})">
            <td>
            ${from_user}
          </td>
          <td>
            ${subject}
          </td>
        </tr>
        `
    })
  }
  cargarMails()
</script>

<style>
  .email-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }

  .email-table th {
    background-color: #3498db;
    color: white;
    text-align: left;
    padding: 12px 15px;
  }

  .email-table td {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
  }

  .email-table tr:hover {
    background-color: #f9f9f9;
    cursor: pointer;
  }

  .email-table .sender {
    width: 25%;
  }

  .email-table .subject {
    width: 45%;
  }
</style>
